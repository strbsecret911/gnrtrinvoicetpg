<!doctype html>
<html lang="id" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Struk Pembelian - TOPUPGRAM</title>

  <!-- Tailwind via CDN (aman untuk GitHub Pages) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet" />

  <style>
    body { box-sizing: border-box; }
    * { font-family: 'Poppins', sans-serif; }
    .mono { font-family: 'JetBrains Mono', monospace; }
    .receipt-paper {
      background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      box-shadow: 0 4px 20px rgba(96, 165, 250, 0.15), 0 1px 3px rgba(0,0,0,0.08);
    }
    .zigzag-top {
      background: linear-gradient(135deg, #dbeafe 25%, transparent 25%) -10px 0,
                  linear-gradient(225deg, #dbeafe 25%, transparent 25%) -10px 0;
      background-size: 20px 10px;
      background-color: transparent;
    }
    .zigzag-bottom {
      background: linear-gradient(315deg, #dbeafe 25%, transparent 25%) 0 0,
                  linear-gradient(45deg, #dbeafe 25%, transparent 25%) 0 0;
      background-size: 20px 10px;
      background-color: transparent;
    }
    .dashed-line { border-top: 2px dashed #bfdbfe; }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #60a5fa;
      box-shadow: 0 0 0 3px rgba(96, 165, 250, 0.2);
    }
    @media print {
      .no-print { display: none !important; }
      .receipt-container { padding: 0 !important; }
    }
  </style>
</head>

<body class="h-full bg-gradient-to-br from-blue-50 via-white to-blue-100 overflow-auto">
  <div class="w-full min-h-full p-4 md:p-8">
    <div class="max-w-2xl mx-auto">

      <!-- Form Input -->
      <div class="no-print bg-white rounded-2xl shadow-lg p-6 mb-6 border border-blue-100">
        <h2 class="text-xl font-bold text-blue-600 mb-4 flex items-center gap-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
          </svg>
          Edit Struk Pembelian
        </h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <!-- Tanggal -->
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-1">Tanggal</label>
            <input type="datetime-local" id="tanggal"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all" />
          </div>

          <!-- No. Struk -->
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-1">No. Struk</label>
            <input type="text" id="noStruk" placeholder="TG-001"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all" />
          </div>

          <!-- Kategori (Search via datalist) -->
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-1">Kategori (Cari Game)</label>
            <input
              type="text"
              id="kategori"
              list="kategoriList"
              placeholder="Ketik untuk cari (mis. Mobile Legends)"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all"
              autocomplete="off"
            />
            <datalist id="kategoriList">
              <option value="Heartopia"></option>
              <option value="Roblox"></option>
              <option value="Mobile Legends"></option>
              <option value="Free Fire"></option>
              <option value="Genshin Impact"></option>
              <option value="Honkai Star Rail"></option>
              <option value="Honor of Kings"></option>
              <option value="Love and Deepspace"></option>
              <option value="Free Fire Max"></option>
              <option value="Magic Chess: Go Go"></option>
              <option value="PUBG Mobile"></option>
              <option value="Call Of Duty Mobile"></option>
              <option value="Where Winds Meet"></option>
              <option value="Delta Force Steam"></option>
              <option value="Delta Force Garena"></option>
              <option value="Crystal of Atlan"></option>
              <option value="Zenless Zone Zero"></option>
              <option value="Valorant"></option>
              <option value="Zepeto"></option>
              <option value="Cloud Song"></option>
              <option value="Growtopia"></option>
              <option value="Marvel Super War"></option>
              <option value="Arena of Valor"></option>
              <option value="Life After"></option>
              <option value="Super Sus"></option>
            </datalist>
            <p class="text-xs text-gray-400 mt-1">Klik field lalu ketik, nanti muncul saran game.</p>
          </div>

          <!-- Produk/Item -->
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-1">Produk/Item</label>
            <input type="text" id="produk" placeholder="Mobile Legends Diamond"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all" />
          </div>

          <!-- Jumlah Order -->
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-1">Jumlah Order</label>
            <input type="text" id="jumlah" placeholder="100 Diamond"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all" />
          </div>

          <!-- Harga -->
          <div>
            <label class="block text-sm font-medium text-gray-600 mb-1">Harga</label>
            <input type="text" id="harga" placeholder="25000"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all" />
          </div>

          <!-- Tujuan -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-600 mb-1">Tujuan (ID/No. HP)</label>
            <input type="text" id="tujuan" placeholder="123456789 (1234)"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all" />
          </div>

          <!-- Keterangan -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-600 mb-1">Keterangan</label>
            <textarea id="keterangan" rows="2" placeholder="Catatan tambahan..."
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all resize-none"></textarea>
          </div>

          <!-- Status -->
          <div class="md:col-span-2">
            <label class="block text-sm font-medium text-gray-600 mb-1">Status</label>
            <select id="status"
              class="w-full px-4 py-2.5 rounded-xl border border-blue-200 bg-blue-50/50 text-gray-700 transition-all">
              <option value="Sukses">‚úÖ Sukses</option>
              <option value="Pending">‚è≥ Pending</option>
              <option value="Gagal">‚ùå Gagal</option>
            </select>
          </div>
        </div>

        <!-- Buttons -->
        <div class="flex gap-3 mt-6">
          <button id="updateBtn"
            class="flex-1 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-6 rounded-xl transition-all transform hover:scale-[1.02] active:scale-[0.98] shadow-lg shadow-blue-200 flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
            Update Struk
          </button>

          <button id="printBtn"
            class="bg-white border-2 border-blue-300 hover:border-blue-400 text-blue-600 font-semibold py-3 px-6 rounded-xl transition-all hover:bg-blue-50 flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
            </svg>
            Print
          </button>
        </div>
      </div>

      <!-- Receipt Preview -->
      <div class="receipt-container">
        <div class="zigzag-top h-3 rounded-t-lg"></div>

        <div class="receipt-paper px-6 py-8">
          <!-- Header -->
          <div class="text-center mb-6">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl mb-3 shadow-lg shadow-blue-200">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
              </svg>
            </div>
            <h1 id="storeName" class="text-2xl font-bold text-blue-600 tracking-wide">TOPUPGRAM</h1>
            <p id="storeTagline" class="text-sm text-gray-500 mt-1">Top Up Cepat &amp; Terpercaya</p>
          </div>

          <div class="dashed-line my-4"></div>

          <!-- Receipt Info -->
          <div class="flex justify-between text-sm text-gray-600 mb-4">
            <span class="mono" id="receiptDate">-</span>
            <span class="mono font-medium text-blue-600" id="receiptNo">-</span>
          </div>

          <div class="dashed-line my-4"></div>

          <!-- Receipt Details -->
          <div class="space-y-3">
            <div class="flex justify-between">
              <span class="text-gray-500 text-sm">Kategori</span>
              <span id="receiptKategori" class="font-medium text-gray-700">-</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 text-sm">Produk</span>
              <span id="receiptProduk" class="font-medium text-gray-700 text-right max-w-[60%]">-</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 text-sm">Jumlah</span>
              <span id="receiptJumlah" class="font-medium text-gray-700">-</span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-500 text-sm">Tujuan</span>
              <span id="receiptTujuan" class="font-medium text-gray-700 mono">-</span>
            </div>
          </div>

          <div class="dashed-line my-4"></div>

          <!-- Keterangan -->
          <div id="keteranganSection" class="mb-4 hidden">
            <span class="text-gray-500 text-sm block mb-1">Keterangan:</span>
            <p id="receiptKeterangan" class="text-gray-700 text-sm bg-blue-50 rounded-lg p-3">-</p>
          </div>

          <!-- Total -->
          <div class="bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 mb-4">
            <div class="flex justify-between items-center">
              <span class="text-gray-600 font-medium">TOTAL</span>
              <span id="receiptHarga" class="text-2xl font-bold text-blue-600">Rp 0</span>
            </div>
          </div>

          <!-- Status Badge -->
          <div class="flex justify-center mb-4">
            <span id="receiptStatus"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold bg-green-100 text-green-700">
              ‚úÖ Sukses
            </span>
          </div>

          <div class="dashed-line my-4"></div>

          <!-- Footer -->
          <div class="text-center">
            <p id="footerText" class="text-gray-500 text-sm">Terima kasih telah berbelanja!</p>
            <p class="text-gray-400 text-xs mt-2">üì± Simpan struk ini sebagai bukti transaksi</p>
          </div>
        </div>

        <div class="zigzag-bottom h-3 rounded-b-lg"></div>
      </div>

    </div>
  </div>

  <script>
    // Format currency
    function formatCurrency(num) {
      const cleaned = (num ?? '').toString().replace(/\D/g, '');
      if (!cleaned) return 'Rp 0';
      return 'Rp ' + parseInt(cleaned, 10).toLocaleString('id-ID');
    }

    // Format date
    function formatDate(dateStr) {
      if (!dateStr) return '-';
      const date = new Date(dateStr);
      const options = { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit' };
      return date.toLocaleDateString('id-ID', options);
    }

    // Set current date/time
    function setCurrentDateTime() {
      const now = new Date();
      const offset = now.getTimezoneOffset() * 60000;
      const localISOTime = new Date(now - offset).toISOString().slice(0, 16);
      document.getElementById('tanggal').value = localISOTime;
    }

    // Generate receipt number
    function generateReceiptNo() {
      const now = new Date();
      const num =
        'TG-' +
        now.getFullYear().toString().slice(-2) +
        String(now.getMonth() + 1).padStart(2, '0') +
        String(now.getDate()).padStart(2, '0') +
        '-' +
        String(Math.floor(Math.random() * 1000)).padStart(3, '0');
      document.getElementById('noStruk').value = num;
    }

    // Update receipt display
    function updateReceipt() {
      const tanggal = document.getElementById('tanggal').value;
      const noStruk = document.getElementById('noStruk').value;
      const kategori = document.getElementById('kategori').value;
      const produk = document.getElementById('produk').value;
      const jumlah = document.getElementById('jumlah').value;
      const harga = document.getElementById('harga').value;
      const tujuan = document.getElementById('tujuan').value;
      const keterangan = document.getElementById('keterangan').value;
      const status = document.getElementById('status').value;

      document.getElementById('receiptDate').textContent = formatDate(tanggal);
      document.getElementById('receiptNo').textContent = noStruk || '-';
      document.getElementById('receiptKategori').textContent = kategori || '-';
      document.getElementById('receiptProduk').textContent = produk || '-';
      document.getElementById('receiptJumlah').textContent = jumlah || '-';
      document.getElementById('receiptTujuan').textContent = tujuan || '-';
      document.getElementById('receiptHarga').textContent = formatCurrency(harga);

      const keteranganSection = document.getElementById('keteranganSection');
      if (keterangan && keterangan.trim()) {
        keteranganSection.classList.remove('hidden');
        document.getElementById('receiptKeterangan').textContent = keterangan;
      } else {
        keteranganSection.classList.add('hidden');
      }

      const statusEl = document.getElementById('receiptStatus');
      if (status === 'Sukses') {
        statusEl.className = 'inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold bg-green-100 text-green-700';
        statusEl.textContent = '‚úÖ Sukses';
      } else if (status === 'Pending') {
        statusEl.className = 'inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold bg-yellow-100 text-yellow-700';
        statusEl.textContent = '‚è≥ Pending';
      } else {
        statusEl.className = 'inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-semibold bg-red-100 text-red-700';
        statusEl.textContent = '‚ùå Gagal';
      }
    }

    // Init
    setCurrentDateTime();
    generateReceiptNo();
    document.getElementById('kategori').value = 'Mobile Legends';
    updateReceipt();

    // Events
    document.getElementById('updateBtn').addEventListener('click', updateReceipt);
    document.getElementById('printBtn').addEventListener('click', () => window.print());

    const inputs = ['tanggal', 'noStruk', 'kategori', 'produk', 'jumlah', 'harga', 'tujuan', 'keterangan', 'status'];
    inputs.forEach((id) => {
      const el = document.getElementById(id);
      if (!el) return;
      el.addEventListener('input', updateReceipt);
      el.addEventListener('change', updateReceipt);
    });
  </script>
</body>
</html>
